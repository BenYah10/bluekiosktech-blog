<body>
  <!-- Decap CMS -->
  <script>
    /* Empêche toute auto-détection de Netlify Identity si présent ailleurs */
    try { delete window.netlifyIdentity; } catch(e) {}
    window.CMS_MANUAL_INIT = true;
  </script>

  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

  <script>
    /* On force le backend GitHub + notre endpoint Vercel */
    CMS.init({
      config: {
        backend: {
          name: 'github',
          repo: 'BenYah10/bluekiosktech-blog',
          branch: 'dev',                // garde 'dev' pour ton flux; mets 'main' si tu veux publier direct
          auth_endpoint: '/api/oauth'
        },
        site_url: 'https://www.bluekiosktech.blog',
        media_folder: 'assets/uploads',
        public_folder: '/assets/uploads',
        publish_mode: 'editorial_workflow',
        i18n: {
          structure: 'multiple_folders',
          locales: ['fr','en'],
          default_locale: 'fr'
        },
        /* On fusionne avec admin/config.yml (collections, champs, etc.) */
        load_config_file: true
      }
    });
  </script>
</body>
